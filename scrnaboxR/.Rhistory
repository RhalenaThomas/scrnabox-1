devtools::install_github(saeidamiri1/scrnabox/scrnaboxR)
devtools::install_github("saeidamiri1/scrnabox/scrnaboxR")
library(ggVennDiagram)
library(gplots)
venn
? venn
library(foreach)
library(doParallel)
install.packages("doParallel")
library(doParallel)
library(scrnaboxR)
library(scrnaboxR)
library(scrnaboxR)
library(scrnaboxR)
package_version <- function(x) {
version <- as.character(unclass(utils::packageVersion(x))[[1]])
if (length(version) > 3) {
version[4:length(version)] <- crayon::red(as.character(version[4:length(version)]))
}
paste0(version, collapse = ".")
}
package_version(" scrnaboxR")
package_version("scRNABox")
library(scrnaboxR)
library(scrnaboxR)
detach("package:scrnaboxR", unload = TRUE)
library(scrnaboxR)
library(scrnaboxR)
detach("package:scrnaboxR", unload = TRUE)
library(scrnaboxR)
package_version <- function(x) {
version <- as.character(unclass(utils::packageVersion(x))[[1]])
if (length(version) > 3) {
version[4:length(version)] <- crayon::red(as.character(version[4:length(version)]))
}
paste0(version, collapse = ".")
}
package_version("tidyverse")
detach("package:scrnaboxR", unload = TRUE)
library(scrnaboxR)
detach("package:scrnaboxR", unload = TRUE)
library(scrnaboxR)
library(scrnaboxR)
install.packages(c("MASS", "nlme"), lib="/usr/local/Cellar/r/4.2.1/lib/R/library")
library(scrnaboxR)
library(scrnaboxR)
library(scrnaboxR)
file_path='/Users/sam/Desktop/sa_int/intract_contrast/DAneurons'
dest_path='/Users/sam/Desktop/final_scrna_dge/test'
split_up_down(file_path,dest_path,cut_pvalue=0.05,cut_log_low=-0.25,cut_log_up=0.25, n_row=200)
file_path<-"/Users/sam/Desktop/final_scrna_dge/test"
file0<-extract_file(file_path)
con<-file0[[2]]
dst<-dist_contrast(con)
dst<-dist_contrast(con)
dst<-dist_contrast(con)
dim <- ncol(dst)
png(file = "/Users/sam/Desktop/final_scrna_dge/test2/heatmap.png", bg = "transparent")
image(1:dim, 1:dim, dst, axes = FALSE, xlab="", ylab="")
label0<-file0[[1]]
axis(1, 1:dim,label0 , cex.axis = 0.5, las=3)
axis(2, 1:dim, label0, cex.axis = 0.5, las=1)
text(expand.grid(1:dim, 1:dim), sprintf("%0.1f", dst), cex=0.6)
dev.off()
gwas_genes<-read.csv('/Users/sam/Library/CloudStorage/OneDrive-SharedLibraries-McGillUniversity/Roxanne LarivieÌ€re, Dr - Dark Genome 2weeks cultures/files/all_PD_gwas_loci_genes_filtered.csv')$hgnc_symbol
des_path='/Users/sam/Desktop/final_scrna_dge/test2'
file_path='/Users/sam/Desktop/final_scrna_dge/test'
dittplot(gwas_genes,file_path,des_path)
setwd("/Users/sam/Desktop/final_scrna_dge/test2")
file0='design1down'
sel_down_genes <- read.csv(paste('/Users/sam/Desktop/final_scrna_dge/test/',file0,'.csv',sep=""))[,1]
sel_vs_norm_go <- clusterProfiler::enrichGO(sel_down_genes,"org.Hs.eg.db",keyType = "SYMBOL",ont = "BP",minGSSize = 50)
write.csv(sel_vs_norm_go@result,file = paste(file0,'enrichGO','.csv',sep=''))
enr_go <- clusterProfiler::simplify(sel_vs_norm_go)
enrichplot::emapplot(enrichplot::pairwise_termsim(enr_go),showCategory = 30, cex_label_category = 0.5)
ggsave(file = "enrich1.pdf")
gmt <- msigdbr::msigdbr(species = "human", category = "H")
sel_vs_norm_enrich <- clusterProfiler::enricher(gene = sel_down_genes,,pAdjustMethod = "BH",pvalueCutoff  = 0.05, qvalueCutoff  = 0.05, TERM2GENE = gmt[,c("gs_name", "gene_symbol")])
write.csv(sel_vs_norm_enrich@result,file = paste(file0,'enricher','.csv',sep=''))
dotplot(enrichplot::pairwise_termsim(enr_go))
library(Seurat)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
setwd("/Users/sam/Desktop/final_scrna_dge/test2")
file0='design1down'
sel_down_genes <- read.csv(paste('/Users/sam/Desktop/final_scrna_dge/test/',file0,'.csv',sep=""))[,1]
sel_vs_norm_go <- clusterProfiler::enrichGO(sel_down_genes,"org.Hs.eg.db",keyType = "SYMBOL",ont = "BP",minGSSize = 50)
write.csv(sel_vs_norm_go@result,file = paste(file0,'enrichGO','.csv',sep=''))
enr_go <- clusterProfiler::simplify(sel_vs_norm_go)
enrichplot::emapplot(enrichplot::pairwise_termsim(enr_go),showCategory = 30, cex_label_category = 0.5)
ggsave(file = "enrich1.pdf")
gmt <- msigdbr::msigdbr(species = "human", category = "H")
sel_vs_norm_enrich <- clusterProfiler::enricher(gene = sel_down_genes,,pAdjustMethod = "BH",pvalueCutoff  = 0.05, qvalueCutoff  = 0.05, TERM2GENE = gmt[,c("gs_name", "gene_symbol")])
write.csv(sel_vs_norm_enrich@result,file = paste(file0,'enricher','.csv',sep=''))
dotplot(enrichplot::pairwise_termsim(enr_go))
dotplot(enrichplot::pairwise_termsim(enr_go))
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
library('EnhancedVolcano')
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano.pdf")
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano.pdf")
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
toptable<-read.csv('/Users/sam/Desktop/final_scrna_dge/test/design1down.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano3.pdf")
setwd("/Users/sam/Desktop/final_scrna_dge/test2")
file0='design1down'
sel_genes0 <- read.csv(paste('/Users/sam/Desktop/final_scrna_dge/test/',file0,'.csv',sep=""))[,1]
sel_genes_go0 <- clusterProfiler::enrichGO(sel_genes0,"org.Hs.eg.db",keyType = "SYMBOL",ont = "BP",minGSSize = 50)
write.csv(sel_genes_go0@result,file = paste(file0,'enrichGO','.csv',sep=''))
enr_go <- clusterProfiler::simplify(sel_genes_go0)
enrichplot::emapplot(enrichplot::pairwise_termsim(enr_go),showCategory = 30, cex_label_category = 0.5)
ggsave(file = "enrich1.pdf")
gmt <- msigdbr::msigdbr(species = "human", category = "H")
sel_go0 <- clusterProfiler::enricher(gene = sel_genes0,,pAdjustMethod = "BH",pvalueCutoff  = 0.05, qvalueCutoff  = 0.05, TERM2GENE = gmt[,c("gs_name", "gene_symbol")])
write.csv(sel_go0@result,file = paste(file0,'enricher','.csv',sep=''))
dotplot(enrichplot::pairwise_termsim(enr_go))
ggsave(file = "dot1.pdf")
cnetplot(enrichplot::pairwise_termsim(enr_go))
ggsave(file = "cnet1.pdf")
library(scrnaboxR)
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
library(EnhancedVolcano)
library(EnhancedVolcano)
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
getwd()
library(EnhancedVolcano)
setwd('/Users/sam/Desktop/final_scrna_dge')
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
dev.off()
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
setwd('/Users/sam/Desktop/final_scrna_dge')
library(EnhancedVolcano)
setwd('/Users/sam/Desktop/final_scrna_dge')
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
rm(list=ls())
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
while (!is.null(dev.list()))  dev.off()
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
dev.set(dev.next())
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
toptable<-read.csv('/Users/sam/Desktop/sa_int/intract_contrast/DAneurons/design1.csv')
EnhancedVolcano(toptable,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - AIW', drawConnectors = TRUE, max.overlaps= 30)
#ggsave(file = "EnhancedVolcano2.pdf")
dev.set(dev.next())
library(scrnaboxR)
.libPaths()
