setwd("/Volumes/F/for_my_website/scrnabox0/scrnabox/scrnaboxrmd")
WDP='/Volumes/F/for_my_website/scrnabox0/related_to_scrnaR'
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(scrnaboxR)
library(Seurat)
library(dplyr)
library(cowplot)
library(ggplot2)
library(pheatmap)
library(enrichR)
library(rafalib)
library(msigdbr)
library(tidyr)
library(tidyverse)
library(fgsea)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
library(Seurat)
library(clusterProfiler)
})
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(cont_a53t),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
fgseaResTidy <- fgseaRes %>% as_tibble() %>% arrange(desc(NES))
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(scrnaboxR)
library(Seurat)
library(dplyr)
library(cowplot)
library(ggplot2)
library(pheatmap)
library(enrichR)
library(rafalib)
library(msigdbr)
library(tidyr)
library(tidyverse)
library(fgsea)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
library(Seurat)
library(clusterProfiler)
})
fgseaResTidy <- fgseaRes %>% as_tibble() %>% arrange(desc(NES))
top_up <- fgseaRes %>% filter(ES > 0) %>% top_n(10, wt=-padj)
fgseaRes <- fgsea(pathways = gmt, stats = genes_rank, minSize = 15, maxSize = 500, scoreType = "pos")
msigdbgmt_subset <- msigdbgmt[msigdbgmt$gs_subcat == "GO:BP", ]
genes_rank <- setNames(mk_genes$avg_log2FC, casefold(rownames(mk_genes),upper = T))
