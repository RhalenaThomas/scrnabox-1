setwd("/Volumes/F/for_my_website/scrnabox0/scrnabox/scrnaboxrmd")
WDP='/Volumes/F/for_my_website/scrnabox0/related_to_scrnaR'
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(scrnaboxR)
library(Seurat)
library(dplyr)
library(cowplot)
library(ggplot2)
library(pheatmap)
library(enrichR)
library(rafalib)
library(msigdbr)
library(tidyr)
library(tidyverse)
library(fgsea)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
library(Seurat)
library(clusterProfiler)
})
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(toptable),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(cont_a53t),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
fgseaResTidy <- fgseaRes %>% as_tibble() %>% arrange(desc(NES))
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(scrnaboxR)
library(Seurat)
library(dplyr)
library(cowplot)
library(ggplot2)
library(pheatmap)
library(enrichR)
library(rafalib)
library(msigdbr)
library(tidyr)
library(tidyverse)
library(fgsea)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
library(Seurat)
library(clusterProfiler)
})
fgseaResTidy <- fgseaRes %>% as_tibble() %>% arrange(desc(NES))
top_up <- fgseaRes %>% filter(ES > 0) %>% top_n(10, wt=-padj)
fgseaRes <- fgsea(pathways = gmt, stats = genes_rank, minSize = 15, maxSize = 500, scoreType = "pos")
msigdbgmt_subset <- msigdbgmt[msigdbgmt$gs_subcat == "GO:BP", ]
genes_rank <- setNames(mk_genes$avg_log2FC, casefold(rownames(mk_genes),upper = T))
knitr::opts_chunk$set(echo = TRUE)
suppressPackageStartupMessages({
library(scrnaboxR)
library(Seurat)
library(dplyr)
library(cowplot)
library(ggplot2)
library(pheatmap)
library(enrichR)
library(rafalib)
library(msigdbr)
library(tidyr)
library(tidyverse)
library(fgsea)
library(clusterProfiler)
library(enrichplot)
library(org.Hs.eg.db)
AnnotationDbi::keytypes(org.Hs.eg.db)
library(Seurat)
library(clusterProfiler)
})
WDP='/Volumes/F/for_my_website/scrnabox0/related_to_scrnaR'
setwd(WDP)
mk_genes<-readRDS(paste0(WDP, "/gdp/de_genes.rds"))
seu.int<-readRDS(paste0(WDP, "/gdp/seu.int.c.rds"))
mk_genes %>%
group_by(cluster) %>%
top_n(-2, p_val_adj) -> top_sel
top_sel
mypar(3, 3, mar = c(5, 5, 3, 3))
for (i in unique(top_sel$cluster)) {
barplot(sort(setNames(top_sel$avg_log2FC, top_sel$gene)[top_sel$cluster == i], F),
horiz = T, las = 1, main = paste0(i, " vs. rest"),)
abline(v = c(0, 0.25))
}
seu.int_sel <- ScaleData(seu.int, features = as.character(unique(top_sel$gene)), assay = "RNA")
DoHeatmap(seu.int_sel, features = as.character(unique(top_sel$gene)), group.by = "cell.types.pool",    assay = "RNA")
DotPlot(seu.int_sel, features = rev(as.character(unique(top_sel$gene))), group.by = "cell.types.pool",
assay = "RNA") + coord_flip()
VlnPlot(seu.int_sel, features = as.character(unique(top_sel$gene)), ncol = 5, group.by = "cell.types.pool", assay = "RNA")
VlnPlot(seu.int_sel, features = as.character(unique(top_sel$gene)), ncol = 3, group.by = "cell.types.pool", assay = "RNA")
VlnPlot(seu.int_sel, features = as.character(unique(top_sel$gene)), ncol = 5, group.by = "cell.types.pool", assay = "RNA")
? VlnPlot
library(htmlwidgets)
library(plotly)
cont_a53t_sig<-cont_a53t[cont_a53t$adj.P.Val<0.05,]
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(cont_a53t),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
library(EnhancedVolcano)
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(cont_a53t),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
library(htmlwidgets)
library(plotly)
cont_a53t_sig<-cont_a53t[cont_a53t$adj.P.Val<0.05,]
p <- plot_ly(data = cont_a53t_sig, x = cont_a53t_sig$logFC, y = -log(cont_a53t_sig$adj.P.Val), text = cont_a53t_sig$X, mode = "markers") %>%
layout(title ="A53T vs rest")
saveWidget(p, "A53T_vs_rest.html")
p
library(htmlwidgets)
library(plotly)
cont_a53t_sig<-cont_a53t[cont_a53t$adj.P.Val<0.05,]
p <- plot_ly(data = cont_a53t_sig, x = cont_a53t_sig$logFC, y = -log(cont_a53t_sig$adj.P.Val), text = cont_a53t_sig$X, mode = "markers") %>% layout(title ="A53T vs rest")
p
#saveWidget(p, "A53T_vs_rest.html")
VlnPlot(seu.int_sel, features = as.character(unique(top_sel$gene)[1:3]), ncol = 5, group.by = "cell.types.pool", assay = "RNA")
VlnPlot(seu.int_sel, features = as.character(unique(top_sel$gene)[1:5]), ncol = 5, group.by = "cell.types.pool", assay = "RNA")
suppressPackageStartupMessages({
library(EnhancedVolcano)
})
cont_a53t<-read.csv(paste0(WDP,'/cont_main/design1.csv'))
EnhancedVolcano(cont_a53t,lab = rownames(cont_a53t),x = 'logFC',  y = 'P.Value', FCcutoff=1, title = 'A53T - rest', drawConnectors = TRUE, max.overlaps= 30)
ggsave(file = "EnhancedVolcano2.pdf")
suppressPackageStartupMessages({
library(htmlwidgets)
library(plotly)
})
cont_a53t_sig<-cont_a53t[cont_a53t$adj.P.Val<0.05,]
p <- plot_ly(data = cont_a53t_sig, x = cont_a53t_sig$logFC, y = -log(cont_a53t_sig$adj.P.Val), text = cont_a53t_sig$X, mode = "markers") %>% layout(title ="A53T vs rest")
p
#saveWidget(p, "A53T_vs_rest.html")
genes_rank <- setNames(mk_genes$avg_log2FC, casefold(rownames(mk_genes),upper = T))
head(genes_rank)
msigdbgmt <- msigdbr::msigdbr("Homo sapiens")
msigdbgmt <- as.data.frame(msigdbgmt)
